<div class="dish-page-container">
  <button routerLink="/dishes" routerLinkActive="active">Back</button>
  <div class="dish-page-right">
    <div class="dish-page-picture">
      <button class="dish-page-picture-button" (click)="prevPhoto()">
        <fa-icon [icon]="faChevronLeft"></fa-icon>
      </button>
      <img [src]="dish.photos[photo]" alt="{{dish.name}} picture">
      <button class="dish-page-picture-button" (click)="nextPhoto()">
        <fa-icon [icon]="faChevronRight"></fa-icon>
      </button>
    </div>
  </div>
  <div class="dish-page-left">
    <h2 class="dish-page-detail">{{dish.name}}</h2>
    <p class="dish-page-detail">Cuisine: {{dish.cuisine | titlecase}}</p>
    <p class="dish-page-detail">Type: {{dish.type}}</p>
    <p class="dish-page-detail">Category: {{dish.category}}</p>
    <p class="dish-page-detail">Available: {{available(dish)}}</p>
    <p class="dish-page-detail">Ordered: {{dish.ordered}}</p>
    <p class="dish-page-detail">Price: {{(dish.price * cartCurrencyService.currencies[cartCurrencyService.currentCurrency].value).toFixed(2)}}
      {{cartCurrencyService.currencies[cartCurrencyService.currentCurrency].symbol}}</p>
    <p class="dish-page-detail">Rating: {{dish.rating}}</p>
    <p class="dish-page-detail">Description: {{dish.description}}</p>
    <div class="dish-page-detail">Ingredients:
     <p class="dish-page-detail" *ngFor="let ingredient of dish.ingredients">
       - {{ingredient}}
     </p>
    </div>
    <div class="dish-page-buy">
      <button class="dish-page-add" (click)="cartCurrencyService.addToCart(dish)" [hidden]="!canAddToCart(dish)">Order dish</button>
      <button class="dish-page-remove" (click)="cartCurrencyService.removeFromCart(dish)">Resign</button>
    </div>
    <p class="dish-page-detail">Rate dish: </p>
    <div class="dish-page-rating">
      <div class="dish-page-star" *ngFor="let star of stars">
        <img [src]="rating >= star && rated ? '../../assets/images/gold_star.png' : '../../assets/images/black_star.png'"
             alt="star"
             (click)="addRating(dish, star)">
      </div>
    </div>
  </div>
  <form class="dish-page-bottom-left" [formGroup]="review" (ngSubmit)="submit()">
    <label for="nick">Nick:</label>
    <input id="nick" type="text" formControlName="nick">
    <p class="dish-page-review-alert" *ngIf="review.get('nick')!.hasError('required') &&
      (review.get('nick')!.touched || review.get('nick')!.dirty)">Nick is required</p>
    <label for="name">Name:</label>
    <input id="name" type="text" formControlName="name">
    <p class="dish-page-review-alert" *ngIf="review.get('name')!.hasError('required') &&
      (review.get('name')!.touched || review.get('name')!.dirty)">Name is required</p>
    <label for="date">Date:</label>
    <input id="date" type="date" formControlName="date">
    <label for="text">Review:</label>
    <input id="text" type="text" formControlName="text">
    <p class="dish-page-review-alert" *ngIf="review.get('text')!.hasError('required') &&
      (review.get('text')!.touched || review.get('text')!.dirty)">Review is required</p>
    <p class="dish-page-review-alert" *ngIf="review.get('text')!.hasError('minlength') &&
      (review.get('text')!.touched || review.get('text')!.dirty)">Review must be at least 50 characters long</p>
    <p class="dish-page-review-alert" *ngIf="review.get('text')!.hasError('maxlength') &&
      (review.get('text')!.touched || review.get('text')!.dirty)">Review cannot be longer than 500 characters</p>
    <button class="dish-page-review-add" type="submit" [disabled]="!review.valid">Add review</button>
  </form>
  <div class="dish-page-bottom-right">
    <p class="dish-page-reviews-title">Reviews:</p>
    <div class="dish-page-reviews">
      <div class="dish-page-reviews-review" *ngFor="let review of dish.reviews">
        <h3>{{review.nick}}</h3>
        <h4>{{review.name}}</h4>
        <h4>{{review.date}}</h4>
        <p>{{review.body}}</p>
      </div>
    </div>
  </div>
</div>
